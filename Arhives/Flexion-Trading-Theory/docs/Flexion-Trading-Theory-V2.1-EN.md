# 1. Structural Overview

Flexion Trading Theory V2.1 defines a fully structural, event-driven framework for interpreting the dynamics of the Flexion field generated by the NFRE engine. The theory eliminates all threshold-based logic, phase-based orientation, discrete extrema heuristics, and parameter tuning, establishing a clean and mathematically consistent architecture grounded in Flexion Dynamics, Flexion Space Theory, and Flexion Time Theory.

V2.1 introduces a strict structural layer responsible for the geometry of curvature C(t), asymmetry ΔS(t), and the structural packet X(t). All structural decisions arise exclusively from geometric turning points—FEW, a structural curvature valley, and FXB, a structural asymmetry peak. These events form the canonical boundaries of structural phases and represent the only valid points where the structural field changes its developmental mode.

Orientation in V2.1 is defined strictly as an event-to-event geometric property. It is derived from the change in curvature between two consecutive structural events, and it remains constant for the entire structural segment that follows. Orientation does not exist inside a phase and is never computed from tick-level noise, price movement, or intra-phase fluctuations.

The theory is explicitly divided into two independent layers:

## Level 1 — Structural Layer
This layer contains the formal structural theory. It defines:
- the structural packet X(t),
- the functions C(t) and ΔS(t),
- structural turning points (FEW and FXB),
- event-based orientation,
- deterministic phase segmentation,
- and structural trading actions.

No thresholds, filters, smoothing, volatility conditions, or price-derived conventions exist in Level 1. All transitions are determined purely by the geometry of the Flexion field.

## Level 2 — Execution Safety Layer
This layer is non-structural and does not modify the underlying geometry. Its only purpose is to prevent the execution of otherwise valid structural signals in unstable, chaotic, or degenerate market conditions. Safety rules may suppress BUY/SELL signals or elevate FXB to override an open position, but they never redefine FEW, FXB, orientation, or phase structure. The structural field always remains the single source of truth.

## System Pipeline
The combined structure produces a universal and deterministic processing pipeline:

1. Price → NFRE → structural packet X(t)
2. Structural geometry → FEW and FXB turning points
3. Events → event-based orientation
4. Orientation + FEW → entry action
5. FXB → mandatory exit
6. Safety layer → suppression in unstable states (without modifying structure)

This architecture ensures complete determinism, mathematical integrity, universal applicability across markets and timeframes, and perfect reproducibility. V2.1 is fully autonomous, independent of market noise, indicator logic, or configuration parameters. All behaviors emerge from structural geometry alone, forming a clean, contradiction-free foundation for algorithmic trading within the Flexion Framework.

---

# 2. Fundamental Objects of the Structural Field

Flexion Trading Theory V2.1 is built on the structural state generated by the NFRE engine. The state at each discrete time t is represented by the structural packet:

X(t) = { C(t), ΔS(t), M(t), T(t), μ(t), Θ(t) }

Each component captures a different geometric or dynamical property of the underlying structural field. The theory depends only on the shape and evolution of these functions. No external parameters, indicators, or thresholds participate in the formation of structural behavior.

## 2.1 Curvature Function C(t)
C(t) is the structural curvature of the Flexion field. It reflects how sharply the structural configuration bends at time t. Curvature evolves as a continuous geometric quantity in NFRE and is the primary driver of structural turning points. A curvature valley defines FEW, the structural entry event. C(t) is not smoothed, filtered, or averaged; its shape alone determines valid minima.

## 2.2 Asymmetry Function ΔS(t)
ΔS(t) measures the directional imbalance of the structural field. It evolves as a smooth geometric function that naturally forms local peaks. A structural asymmetry peak defines FXB, the mandatory exit event. ΔS(t) is independent of price volatility, momentum, or trend; it encodes structural imbalance only.

## 2.3 Mass Function M(t)
M(t) represents accumulated structural mass. It reflects how strongly the field resists perturbation and contributes to the stability of phases. M(t) does not directly create events but shapes the internal geometry of the structural packet.

## 2.4 Temporal Density T(t)
T(t) encodes structural time density—how quickly structural change accumulates. High temporal density corresponds to rapid structural evolution; low density corresponds to slowed or stalled structural progression. T(t) influences the rhythm of event spacing but does not define turning points.

## 2.5 Mean Deviation μ(t)
μ(t) measures the structural deviation from the current equilibrium trajectory. It is used internally by NFRE to maintain geometric consistency of the field. μ(t) must remain finite and structurally meaningful for events to be considered valid.

## 2.6 Angular Field Θ(t)
Θ(t) describes the angular component of structural orientation in the Flexion space. It contributes to shape coherence and must remain defined for the structural packet to be valid. Undefined or divergent Θ(t) results in structural degeneracy, triggering NONE at the safety layer.

## 2.7 Discrete Structural Flow
Although the market provides discrete ticks, the NFRE engine constructs continuous structural functions. V2.1 interprets the discrete sequence X(t) as samples of a continuous structural flow. Decisions are made only at structural turning points, not at individual ticks.

## 2.8 Independence From Price
None of the structural functions depend on price magnitude, returns, volatility, or patterns. NFRE transforms raw price data into a purely geometric field. Flexion Trading Theory operates exclusively on this field and is invariant across markets, timeframes, and scales.

The structural packet X(t) is the sole source of the theory’s behavior. All events, orientation, and trading actions originate from the intrinsic geometry of C(t) and ΔS(t), supported by the consistency conditions of the remaining components of the structural field.

---

# 3. Structural Events (Turning Points)

Structural events are the fundamental markers of change in the Flexion field. They arise exclusively from the intrinsic geometric shape of the curvature function C(t) and the asymmetry function ΔS(t). Events do not depend on thresholds, tick comparisons, windows, or price-derived heuristics. They are determined purely by the structural geometry generated by the NFRE engine.

There are exactly two structural events in Flexion Trading Theory V2.1:

1. FEW — the structural curvature valley
2. FXB — the structural asymmetry peak

These events define the beginning and end of each structural phase, and no other events exist within the theory.

## 3.1 FEW — Flexion Entry Window (Curvature Valley)
FEW occurs when the curvature function C(t) reaches a geometric local minimum. A curvature valley is defined as a point at which the surrounding shape of C(t) transitions from downward bending to upward bending in the continuous geometric interpretation produced by NFRE.

Properties of FEW:
- it marks the beginning of a new structural segment,
- it represents the moment of minimal structural curvature,
- it signifies a structural “reset” in the developmental trajectory,
- it does not imply direction by itself.

FEW is not identified by comparing discrete neighbors. It emerges only when the geometric form of C(t) exhibits a genuine valley, as determined internally by nfRE’s continuous structural reconstruction.

## 3.2 FXB — Flexion Exit Boundary (Asymmetry Peak)
FXB occurs when the asymmetry function ΔS(t) reaches a geometric local maximum. An asymmetry peak is a point where the shape of ΔS(t) transitions from rising imbalance to falling imbalance.

Properties of FXB:
- it marks the end of the current structural segment,
- it represents the moment of maximal structural asymmetry,
- it always forces a structural exit signal,
- it terminates the active orientation and completes the phase.

Like FEW, FXB is not determined by discrete comparisons but by the complete local geometric profile of ΔS(t).

## 3.3 Event Exclusivity
FEW and FXB represent mutually exclusive geometric states. A curvature valley cannot coincide with an asymmetry peak, and vice versa. Therefore:
- FEW and FXB cannot occur at the same structural position,
- no structural ambiguity exists between the two.

## 3.4 Event Ordering
All structural events obey strict temporal ordering:

FEWₖ < FXBₖ < FEWₖ₊₁ < FXBₖ₊₁ < …

This ordering emerges naturally from the geometry of the structural field:
- curvature valleys precede asymmetry peaks within each structural cycle,
- each cycle is self-contained,
- no overlaps, no merges, and no nested events occur.

## 3.5 Event Autonomy
Structural events depend solely on the intrinsic geometry of C(t) and ΔS(t). They do not depend on:
- price,
- volatility,
- indicators,
- thresholds,
- smoothing windows,
- configurable parameters,
- or any platform-specific mechanics.

NFRE determines FEW and FXB from the continuous structural field without external influence.

## 3.6 Event Consequences
FEW and FXB define the structural boundaries of a phase. They determine:
- where orientation is evaluated,
- when a trade may begin,
- when a trade must end,
- and how the structural flow is segmented into deterministic cycles.

Events are the only valid triggers for trading interpretation. No other moment may initiate or terminate structural action.

---

# 4. Event-Based Orientation

Event-Based Orientation is the core directional mechanism of Flexion Trading Theory V2.1. Orientation is derived exclusively from the change in structural curvature between two consecutive turning points. It is not defined at any other moment, does not depend on intra-phase fluctuations, and never uses tick-level information or price-based features.

Orientation emerges only at structural events, and only as a comparison between events. It is a discrete, deterministic property of the structural field that governs how the next structural segment evolves.

## 4.1 Definition
Let t₁ and t₂ be two consecutive structural events (FEW or FXB). The structural orientation at event t₂ is determined by the event-to-event curvature difference:

Slope = C(t₂) − C(t₁)

Orientation is then defined categorically:

- UP   if Slope > 0
- DOWN if Slope < 0
- undefined if Slope = 0 (no directional information)

Orientation cannot be evaluated without two events. It is strictly an inter-event property.

## 4.2 Orientation Exists Only at Events
Orientation does not exist inside a structural phase. V2.1 does not allow any intra-phase or tick-based orientation. Only structural events carry directional meaning. Therefore:

- orientation is defined at FEW and FXB only,
- orientation remains constant throughout the entire phase that follows the event,
- orientation cannot change until the next structural event occurs.

## 4.3 Orientation Does Not Depend on Price
Orientation uses only the structural curvature C(t), not price, returns, volatility, or momentum. The structural field may rise while price falls, or price may rise while the structural field contracts; orientation remains valid in both cases. The orientation reflects the direction of geometric development, not market movement.

## 4.4 No Continuous Orientation
Flexion Trading Theory V2.1 prohibits any form of continuous or sliding orientation:

- no moving differences,
- no tick-level slopes,
- no intra-phase derivative estimation,
- no running shape analysis.

Orientation is discrete and event-driven. The structural field evolves continuously, but directional meaning emerges only at event boundaries.

## 4.5 Orientation Lifetime
Once computed at event t₂, orientation applies to the entire structural segment:

Φₖ = [ t₂ , next FXB ]

Orientation is not updated inside the segment. It defines the developmental direction of the phase and remains immutable until the next event occurs.

## 4.6 Independence From Noise
Because orientation uses only event-level information, it is immune to:
- micro-oscillations,
- tick-level noise,
- candle compression,
- arbitrary timeframe selection,
- abrupt price movements.

Orientation reflects a property of structural geometry, not the market feed.

## 4.7 Orientation and Trading Interpretation
Orientation alone does not trigger a trade. It becomes actionable only when evaluated at a FEW event:

- FEW + Orientation UP   → FEW_UP (BUY)
- FEW + Orientation DOWN → FEW_DOWN (SELL)

FXB always overrides orientation and commands EXIT. Orientation can never reverse a decision inside the segment.

## 4.8 Summary
Event-Based Orientation is:

- discrete,
- deterministic,
- geometry-driven,
- event-to-event,
- invariant under price scale and timeframe,
- stable for the entire structural phase.

It is the only directional property used by the theory, and the only component that maps structural evolution into trading actions.

---

# 5. Flexion Phases (Structural Segments)

Flexion Phases are the fundamental structural intervals that emerge naturally from the ordering of events FEW and FXB. Each phase represents a continuous segment of structural evolution governed by a single orientation. Phases are deterministic, non-overlapping, and fully defined by the geometry of the structural field. No price-based logic, thresholds, or heuristics participate in their formation.

## 5.1 Definition of a Phase
A Flexion Phase Φₖ is the closed structural segment bounded by two consecutive events:

Φₖ = [ FEWₖ , FXBₖ ]

with strict ordering FEWₖ < FXBₖ.  
No other events occur inside Φₖ.  
A phase begins at the curvature valley FEWₖ and ends at the asymmetry peak FXBₖ.

## 5.2 Phase Validity
A phase is valid if and only if:

1. FEWₖ is a genuine geometric curvature valley,
2. FXBₖ is a genuine geometric asymmetry peak,
3. no FEW or FXB events occur inside the interval,
4. the structural functions C(t) and ΔS(t) evolve continuously and coherently.

If any of these conditions fail, the phase is invalid and produces no structural interpretation.

## 5.3 Phase Autonomy
Each phase is a self-contained structural entity. Its existence and properties come entirely from:

- the shape of C(t),
- the shape of ΔS(t),
- the event-to-event orientation.

Phases do not depend on:
- timeframe,
- volatility,
- price movement,
- statistical indicators,
- external tuning parameters.

The geometry of the structural field autonomously determines all phases.

## 5.4 Orientation Across a Phase
Orientation is computed at the event preceding the phase:

Orientation(Φₖ) = Orientation(FEWₖ)

and remains constant for the entire interval:

t ∈ Φₖ → Orientation(t) = Orientation(FEWₖ)

A phase cannot internally modify, reverse, or redefine orientation. Structural direction is fixed from FEWₖ to FXBₖ.

## 5.5 No Intra-Phase Events
By definition:

- FEW cannot occur inside a phase,
- FXB cannot occur twice inside a phase,
- no derivative events or intermediate turning points exist.

Structural development inside Φₖ is continuous but event-free. All significant turning points are already captured by FEW and FXB.

## 5.6 Deterministic Segmentation
Given the structural sequences C(t) and ΔS(t), the set of phases is unique and deterministic. There is exactly one segmentation of the timeline into valid structural phases satisfying:

FEW₁ < FXB₁ < FEW₂ < FXB₂ < FEW₃ < …

No ambiguity, randomness, or alternative interpretations exist.

## 5.7 Structural Meaning of a Phase
A Flexion Phase represents:

- a single direction of structural evolution,
- a stable geometric configuration,
- a deterministic developmental interval,
- a complete structural cycle segment.

FEW marks structural renewal; FXB marks structural exhaustion.

## 5.8 Relationship to Trading
The phase provides the structural boundaries for trading actions:

- Entry is permitted only at FEWₖ,
- Direction is determined by orientation at FEWₖ,
- Exit is mandatory at FXBₖ,
- No other trading action is valid inside the phase.

Trading logic is a direct interpretation of phase structure.

## 5.9 Summary
A Flexion Phase is a pure structural segment defined by two turning points. It is event-bound, deterministic, orientation-consistent, and invariant under all market-specific transformations. Phases are the backbone of Flexion Trading Theory, enabling a clean mapping from geometric structure to trading decisions.

---

# 6. Trading Interpretation Layer (Structural → Trading)

The Trading Interpretation Layer maps the structural behavior of the Flexion field into actionable trading signals. This layer does not modify structural geometry, does not influence NFRE output, and does not introduce new logic beyond event-driven interpretation. Every trading action is a direct and deterministic consequence of structural events and orientation.

There are three valid trading actions in Flexion Trading Theory V2.1:

- FEW_UP   → open BUY
- FEW_DOWN → open SELL
- FXB      → close all positions

Any moment without a structural event produces NONE, indicating that no trading action is permitted.

## 6.1 Event-Based Entry Logic
A position may only be opened at a FEW event. FEW marks the beginning of a structural phase and represents the only valid entry point. The direction of the entry is determined by event-based orientation:

- FEW + Orientation UP   → FEW_UP  (BUY)
- FEW + Orientation DOWN → FEW_DOWN (SELL)
- FEW with undefined orientation → NONE (no entry)

No trading action other than BUY or SELL can be associated with FEW. FEW does not produce exit signals, reversals, or modifications of existing positions.

## 6.2 Event-Based Exit Logic
FXB represents the structural boundary of the phase. When FXB occurs:

- all open positions must be closed,
- no new position may be opened,
- no reversal is permitted,
- the system enters a neutral state until the next FEW.

FXB is an unconditional exit. It overrides all internal states and interpretations. Any active trade must be terminated immediately and completely at FXB.

## 6.3 No Actions Inside a Phase
Between FEWₖ and FXBₖ:

- no new entries may occur,
- no partial actions are permitted,
- no interpretation of slope, price movement, or structural noise is allowed.

The system must output NONE for every tick inside the phase. The internal structure may evolve, but no trading decisions emerge until FXBₖ is reached.

## 6.4 One Position Per Phase
The theory permits exactly one position per phase. After entering at FEWₖ:

- no additional entries may occur,
- no pyramiding is allowed,
- no re-entry inside the same phase is valid.

This restriction ensures that each phase corresponds to a single, clean structural action aligned with the underlying geometric direction.

## 6.5 Structural Purity
Trading decisions depend only on:

1. structural events (FEW and FXB),
2. event-based orientation,
3. the validity of the phase.

They do not depend on:

- price patterns,
- technical indicators,
- volatility,
- thresholds,
- momentum,
- statistical measures,
- heuristics.

The trading layer is a passive interpreter of structural geometry, not an analytical component.

## 6.6 Deterministic Behavior
Given a sequence of structural events and curvature values, the trading actions produced by the theory are fully deterministic:

- FEW determines when to enter,
- Orientation determines how to enter,
- FXB determines when to exit.

No randomness or alternative pathways exist.

## 6.7 Universality
Because all decisions originate from structural geometry rather than market-specific properties, the theory applies identically to:

- forex markets,
- crypto markets,
- equities,
- commodities,
- any timeframe,
- any data frequency.

The trading layer inherits the universality of the structural layer.

## 6.8 Summary
The Trading Interpretation Layer is a minimal, deterministic mapping from structural events to trading actions. FEW initiates a trade according to structural orientation; FXB terminates it unconditionally. All intermediate states yield NONE. This ensures perfect structural segmentation, complete determinism, and a clean correspondence between structural geometry and executable actions.

---

# 7. Execution Safety Layer

The Execution Safety Layer is a non-structural protective layer that prevents the execution of structurally valid signals under market conditions where execution would be unreliable, unstable, or inconsistent with practical trading constraints. This layer does not modify structural geometry, does not redefine FEW or FXB, and does not influence orientation. Its sole purpose is to ensure that real-world execution does not compromise the theoretical correctness of the system.

Safety rules may suppress FEW_UP or FEW_DOWN signals or elevate FXB to override an active trade, but they never alter the structural sequence of events or structural segmentation. The structural layer (Level 1) remains the single source of truth; the execution layer (Level 2) acts only as a filter to protect against pathological states.

## 7.1 Independence From Structure
Execution safety rules operate strictly after structural signals are generated. They do not participate in:

- event detection,
- orientation calculation,
- phase construction,
- or structural validation.

All structural decisions are final and cannot be changed by the safety layer. Safety rules only determine whether the platform should execute the action.

## 7.2 Conditions That Trigger Safety Suppression
The safety layer suppresses BUY and SELL signals and may elevate FXB when the following conditions occur:

### 1. Structural Degeneracy
If any component of the structural packet becomes undefined, non-finite, or incoherent:
- C(t), ΔS(t), M(t), T(t), μ(t), Θ(t) ∉ valid structural domain
then the output must be NONE.

### 2. Temporal Incoherence
If the structural state fluctuates in a way that indicates incomplete or unstable formation of the current event:
- FEW not fully formed,
- FXB not fully formed,
- orientation not yet resolved,
the safety layer suppresses action until coherence is restored.

### 3. Instability or Collapse Proximity
When the structural flow approaches collapse-like geometry or extreme imbalance, the safety layer activates FXB override:

- BUY/SELL forbidden,
- EXIT becomes mandatory.

### 4. Excessive Structural Noise
If C(t) or ΔS(t) enters a micro-oscillation regime that does not affect structural topology but would produce unstable execution conditions, the safety layer outputs NONE until the noise dissipates.

## 7.3 FXB Override
If safety conditions represent high structural risk, FXB takes precedence over all other signals. This means:

- if an open position exists → close immediately,
- if no position is open → do nothing,
- BUY or SELL may not be executed under any circumstances.

FXB override ensures that no new exposure is taken and that the system withdraws from dangerous structural zones.

## 7.4 NONE Enforcement
When a structural signal is valid but execution conditions are unsafe, the safety layer returns NONE. NONE means:

- do not open a position,
- do not close a position unless FXB override is active,
- wait for stable structural geometry.

NONE does not imply structural invalidity; it represents execution suppression only.

## 7.5 Safety Does Not Change Structure
The safety layer is forbidden from:

- redefining FEW or FXB,
- adjusting curvature or asymmetry values,
- modifying orientation,
- splitting or merging phases,
- altering the sequence of events.

FEW and FXB remain structurally absolute regardless of safety conditions.

## 7.6 Universality of Safety Rules
Safety conditions are universal across markets because they depend solely on the internal coherence of the structural packet, not on price patterns or statistical parameters. They apply identically across:

- tick data,
- candle data,
- all assets,
- all timeframes,
- all volatility regimes.

## 7.7 Summary
The Execution Safety Layer protects the trading system from unreliable execution while preserving the full integrity of structural logic. It may suppress or override actions but never changes structural events or orientation. Structural theory defines what is true; safety rules define what is safe to execute. The separation ensures that Flexion Trading Theory remains mathematically pure while remaining usable in real-world trading systems.

---

# 8. Flexion Trading API (SDK Contract)

The Flexion Trading API defines the strict interface between the structural engine (NFRE), its compiled execution layer (DLL), and any external trading platform such as MT4, MT5, cTrader, or custom environments. The API does not compute structure; it only transmits structural decisions. It is immutable, deterministic, and independent of runtime configuration.

The API provides exactly one entry point for trading decisions. All logic inside this interface follows directly from the structural theory defined in Part I of this document.

## 8.1 Single Mandatory Function
All platforms must import and call the following function:

int EvaluateTick(double price, int timestamp, uchar &buffer[], int buf_size);

This function is the only official external interface of the Flexion Trading Engine.  
Its signature, argument order, and types must never be modified.

## 8.2 Inputs
EvaluateTick receives:

- price: the current tick price,
- timestamp: the current time in integer form,
- buffer: a pre-allocated uchar array for output,
- buf_size: size of the buffer.

No other inputs are allowed.  
No thresholds, parameters, or configuration values may be passed into the engine.

## 8.3 Outputs
The engine writes a structured binary response into buffer[]:

### Byte 0 — Signal Code
0 = NONE  
1 = FEW_UP  
2 = FEW_DOWN  
3 = FXB  

This byte represents the trading instruction after applying Level 1 structural logic and Level 2 safety filtering.

### Bytes 1+ — Structural Parameters (optional diagnostics)
The following values are written as double-precision IEEE-754 floats:

1. C(t)  
2. ΔS(t)  
3. T(t)  
4. M(t)  
5. μ(t)  
6. Θ(t)

These parameters are diagnostic only.  
External systems must not modify behavior based on them.

## 8.4 Return Value
The function returns the number of bytes written to buffer[].  
If the return value is zero or negative, the output must be ignored.

## 8.5 Deterministic Behavior
Given identical input streams (price, timestamp), the engine must always produce:

- identical C(t), ΔS(t), and structural packets,
- identical FEW and FXB events,
- identical orientation,
- identical trading signals,
- and identical safety decisions.

The API exposes a deterministic structural engine. No randomness exists in the system.

## 8.6 Platform Rules
The calling platform must interpret signals strictly:

- FEW_UP   → open BUY  
- FEW_DOWN → open SELL  
- FXB      → close all open trades immediately  
- NONE     → take no action  

The platform must not infer structure, detect events, compute orientation, or apply price-based logic.

## 8.7 Buffer Handling Requirements
Before calling EvaluateTick, the buffer must be:

- allocated with sufficient size (at least 64 bytes),
- fully zero-initialized.

Reading beyond returned length is forbidden.  
Modifying buffer contents after the function call does not alter internal structural state.

## 8.8 No Reverse Communication
The platform must not send configuration, tuning parameters, or indicators into the engine. All structure is generated internally. No price-based or user-defined adjustments to structural variables are permitted.

## 8.9 Multi-Platform Consistency
The API behaves identically across all supported environments:

- MT4,
- MT5,
- cTrader,
- algorithmic engines,
- research backtesting tools.

This ensures universal reproducibility of structural logic and correctness of trading actions.

## 8.10 Summary
The Flexion Trading API is a minimal, strict, and deterministic interface that exposes structural event decisions without revealing internal computation. It guarantees that every trading action originates from the structural geometry of C(t) and ΔS(t), filtered by safety logic, and that all platforms execute the same decisions consistently.

---

# 9. Computational Model (NFRE → Engine → Signals)

The Computational Model formalizes how raw market data is transformed into structural signals and executable trading actions. This process is fully deterministic and consists of three layers: NFRE (structural generation), the Flexion Trading Engine (event and orientation extraction), and the execution interface (API output). No randomness, statistical assumptions, or configurable parameters participate in any stage.

## 9.1 Price Input
The system receives a discrete stream of observable market ticks:

P(t),   t = 1, 2, 3, ...

Only price and timestamp are provided.  
No indicators, volatility measures, or derived metrics are used as inputs.

## 9.2 Structural Transformation (NFRE Core)
NFRE converts the observable tick stream into a continuous structural field represented by the structural packet:

X(t) = { C(t), ΔS(t), M(t), T(t), μ(t), Θ(t) }

NFRE reconstructs C(t) and ΔS(t) as geometric functions, not statistical ones.  
It applies no smoothing, no moving averages, no window functions, and no heuristics.  
C(t) and ΔS(t) are pure expressions of structural geometry.

The structural packet must remain coherent, finite, and continuous for event detection to proceed.

## 9.3 Turning Point Detection
The engine identifies two structural events:

- FEW — curvature valley (geometric minimum of C(t))
- FXB — asymmetry peak (geometric maximum of ΔS(t))

Turning points are detected from the shape of the underlying structural functions.  
Discrete comparisons or threshold-based rules are not used.  
Events are unique, exclusive, and ordered.

## 9.4 Phase Construction
Once FEW and FXB are identified, the engine constructs deterministic structural phases:

Φₖ = [ FEWₖ , FXBₖ ]

Phases represent the core segmentation of the structural flow.  
No events may occur inside a phase; no overlaps or nested phases are possible.

## 9.5 Orientation Extraction
Orientation is computed only at structural events.  
Given two consecutive events t₁ and t₂:

Slope = C(t₂) − C(t₁)

Orientation(t₂) =
- UP if Slope > 0
- DOWN if Slope < 0
- undefined if Slope = 0

Orientation remains constant for the entire phase that follows.

## 9.6 Signal Formation
Trading signals are derived directly from structural events:

- FEW + UP   → FEW_UP
- FEW + DOWN → FEW_DOWN
- FXB        → EXIT

If no event occurs at time t, the output is NONE.

Multiple signals cannot occur simultaneously.  
FXB overrides all other actions.

## 9.7 Safety Filtering
After structural signals are formed, the safety layer evaluates execution conditions.  
Possible outcomes:

- FEW_UP/F EW_DOWN allowed → action passed through
- FEW_UP/FEW_DOWN suppressed → output NONE
- FXB override triggered → output FXB

Safety logic does not alter structural definitions or orientation.

## 9.8 API Output
EvaluateTick returns:

- a categorical signal code (NONE, FEW_UP, FEW_DOWN, FXB),
- structural parameters for diagnostics,
- and a deterministic byte count.

The API is the final stage of the computational model and must reflect structural and safety decisions exactly.

## 9.9 Deterministic Workflow Summary
Given identical P(t):

1. NFRE produces identical structural packets X(t).
2. Engine detects identical FEW and FXB events.
3. Engine computes identical orientation.
4. Engine forms identical trading signals.
5. Safety layer applies identical filtering.
6. API outputs identical instructions.

No randomness or non-deterministic branching is permitted.  
The computational model guarantees reproducibility across platforms and timeframes.

## 9.10 Error Handling
If NFRE outputs an invalid or undefined structural packet at time t:
- no event detection occurs,
- orientation is not updated,
- trading action defaults to NONE,
- open positions are preserved unless safety triggers FXB override.

Structural invalidity must not propagate beyond a single tick.

This ensures robustness of the trading system under all market conditions.

---

# 10. Formal Definitions & Axioms (V2.1)

This section presents the foundational mathematical definitions and axioms of Flexion Trading Theory V2.1. These statements form the immutable core of the theory. All structural logic, event detection, orientation, and trading signals derive strictly from these principles. No external assumptions, thresholds, or market-specific heuristics may override or modify them.

# 10.1 Structural State Definition
The structural state at time t is defined as the structural packet:

X(t) = { C(t), ΔS(t), M(t), T(t), μ(t), Θ(t) }

All components are generated by NFRE.  
The packet must be finite, continuous, and structurally coherent.

# 10.2 Curvature and Asymmetry
C(t) and ΔS(t) are continuous geometric functions reconstructed by NFRE:

- C(t) represents structural curvature,
- ΔS(t) represents structural asymmetry.

Only their geometric shape determines structural turning points.  
No smoothing, filtering, discretization heuristics, or thresholds may be applied.

# 10.3 Events (Turning Points)
There are exactly two structural events:

1. FEW — a geometric curvature valley  
2. FXB — a geometric asymmetry peak

Events occur when the structural shape exhibits a genuine local minimum (for C) or local maximum (for ΔS). Events are unique, mutually exclusive, and strictly ordered.

# 10.4 Event Ordering Axiom
Events follow an invariant ordering:

FEWₖ < FXBₖ < FEWₖ₊₁ < FXBₖ₊₁ < …

No nested or overlapping events exist.  
No other types of events are permitted.

# 10.5 Phase Definition
A phase Φₖ is defined as:

Φₖ = [ FEWₖ , FXBₖ ]

A phase is valid if:
- FEWₖ is a geometric curvature valley,
- FXBₖ is a geometric asymmetry peak,
- no events occur inside the interval,
- C(t) and ΔS(t) evolve continuously.

Phases represent deterministic structural segments.

# 10.6 Orientation Definition
Orientation is an event-to-event geometric property.  
Given two consecutive events t₁ and t₂:

Slope = C(t₂) − C(t₁)

Orientation(t₂) is defined as:
- UP if Slope > 0
- DOWN if Slope < 0
- undefined if Slope = 0

Orientation is defined only at events and remains constant until the next event.

# 10.7 No Intra-Phase Orientation
Orientation does not exist inside a phase.  
Orientation cannot be updated, reversed, or recalculated between events.  
No tick-level or window-based orientation is permitted.

# 10.8 Structural Autonomy Axiom
All structural decisions must originate solely from:

- C(t),
- ΔS(t),
- the structural packet X(t),
- event ordering,
- and orientation defined by event-to-event curvature.

No external information—price trends, indicators, volatility, thresholds, statistical filters—may influence structural logic.

# 10.9 Trading Logic Axiom
Trading actions follow directly from structural events:

- FEW + Orientation UP   → FEW_UP
- FEW + Orientation DOWN → FEW_DOWN
- FXB → EXIT
- No event → NONE

No other trading actions are valid under structural theory.

# 10.10 Determinism Axiom
Given identical input price streams P(t), the structural engine must produce:

- identical C(t) and ΔS(t),
- identical event sets {FEWₖ, FXBₖ},
- identical orientations,
- identical phases,
- identical structural trading actions.

Determinism is absolute and must hold across platforms, timeframes, and environments.

# 10.11 No Thresholds or Tunable Parameters
Structural theory forbids any numeric thresholds, configurable margins, volatility filters, or user-defined parameters. All structure emerges intrinsically from geometric properties of C(t) and ΔS(t).

# 10.12 Safety Layer Separation
The Execution Safety Layer may suppress or override trading signals, but must not:

- modify structural events,
- modify orientation,
- alter phase boundaries,
- redefine criteria for FEW or FXB.

Structure is absolute; execution safety is conditional.

# 10.13 Summary
These definitions and axioms form the foundational rules of Flexion Trading Theory V2.1. All structural computations, trading interpretations, and API outputs derive from these statements without exception. Nothing outside this axiomatic system may influence structural behavior.

---

# Appendix A — Mathematical Model

This appendix formalizes the mathematical foundation of Flexion Trading Theory V2.1. The definitions presented here clarify the geometric structure of curvature, asymmetry, and turning points, ensuring full compatibility with NFRE’s continuous structural reconstruction. All statements below are purely structural and contain no thresholds, smoothing filters, or heuristic approximations.

# A.1 Structural Functions

## A.1.1 Curvature Function C(t)
C(t) is a continuous geometric function representing structural curvature.  
It captures how sharply the structural field bends at time t.  
NFRE computes C(t) as part of the continuous structural packet and guarantees:

- continuity,
- finiteness,
- differentiability in the structural sense,
- and geometric coherence.

C(t) serves as the basis for detecting curvature valleys.

## A.1.2 Asymmetry Function ΔS(t)
ΔS(t) is a continuous geometric function representing structural imbalance.  
It quantifies deviation from symmetric structural flow and evolves smoothly.  
ΔS(t) naturally forms local maxima corresponding to structural exhaustion points.  
These maxima define FXB events.

## A.1.3 Higher-Order Structural Behavior
Although NFRE does not expose explicit derivatives, the continuous nature of C(t) and ΔS(t) allows the structural engine to detect turning points using geometric shape analysis. The theory assumes that:

- curvature has well-defined local minima,
- asymmetry has well-defined local maxima,
- structural transitions are observable from the shape alone.

No discrete operators or finite-difference approximations are part of the theory.

# A.2 Turning Points (FEW and FXB)

## A.2.1 Geometric Curvature Valley — FEW
FEWₖ is defined as a geometric local minimum of curvature C(t).  
Formally, FEWₖ occurs at t = τ where:

1. C(t) exhibits decreasing curvature before τ,
2. C(t) exhibits increasing curvature after τ,
3. τ is a genuine valley in the structural geometry.

NFRE determines valleys by analyzing local geometric shape, not by comparing adjacent samples.

## A.2.2 Geometric Asymmetry Peak — FXB
FXBₖ is defined as a geometric local maximum of asymmetry ΔS(t).  
At t = λ:

1. ΔS(t) grows prior to λ,
2. ΔS(t) declines after λ,
3. λ is a genuine peak in the structural geometry.

FXB represents the structural boundary at which asymmetry reaches exhaustion.

## A.2.3 Event Exclusivity and Ordering
FEW and FXB cannot coincide.  
Their ordering is strictly monotonic:

FEWₖ < FXBₖ < FEWₖ₊₁ < FXBₖ₊₁ …

These conditions follow naturally from curvature and asymmetry geometry and do not require additional rules.

# A.3 Orientation

## A.3.1 Event-to-Event Curvature Difference
Orientation derives from the curvature change between consecutive events.  
For events t₁ and t₂:

Slope = C(t₂) − C(t₁)

Orientation(t₂) is defined by:

- UP   if Slope > 0,
- DOWN if Slope < 0,
- undefined if Slope = 0.

Only event-level values of C(t) participate in orientation.  
No intra-phase curvature analysis is permitted.

## A.3.2 Orientation Stability
Orientation remains fixed throughout the entire subsequent phase:

t ∈ Φₖ = [ FEWₖ , FXBₖ ] → Orientation(t) = Orientation(FEWₖ)

Orientation cannot reverse or oscillate within a phase.

# A.4 Phase Construction

## A.4.1 Structural Segment Definition
A phase Φₖ is defined as the interval:

Φₖ = [ FEWₖ , FXBₖ ]

This interval is fully determined by geometric turning points.  
No other boundaries are valid.

## A.4.2 Phase Validity Conditions
A phase is valid if:

1. FEWₖ is a true geometric valley,
2. FXBₖ is a true geometric peak,
3. no FEW or FXB occurs inside Φₖ,
4. the structural packet is continuous and finite.

Invalid phases produce no trading signals.

# A.5 Trading Signals

## A.5.1 Signal Assignment
Trading actions arise directly from structural events:

- FEW_UP   if FEWₖ occurs and Orientation = UP,
- FEW_DOWN if FEWₖ occurs and Orientation = DOWN,
- FXB      for all FXB events.

All other time steps yield NONE.

## A.5.2 One Action Per Event
Each event produces exactly one signal.  
Multiple actions cannot arise from a single structural event.

# A.6 Structural Invariance

## A.6.1 Scale Invariance
Structural functions C(t) and ΔS(t) depend only on geometric evolution of the field.  
They are invariant under:

- price scaling,
- volatility regimes,
- asset type,
- timeframe compression or expansion.

## A.6.2 Deterministic Reconstruction
Given identical tick streams, NFRE must reconstruct identical:

- structural packets,
- turning points,
- orientations,
- phase sequences,
- trading events.

# A.7 Summary
The mathematical model establishes the geometric foundation for structural detection, event ordering, orientation evaluation, and phase segmentation. Together, these constructs form the complete mathematical basis for Flexion Trading Theory V2.1, ensuring clarity, determinism, and full structural autonomy.

---

# Appendix B — DLL/MT4 Example Implementation

This appendix provides a reference Expert Advisor implementation for MetaTrader 4 that integrates with the Flexion Trading Engine via the EvaluateTick API. The example demonstrates how to correctly call the DLL, interpret signal codes, and execute trades without modifying or inferring structural logic. All structure remains inside NFRE and the engine; the EA only handles execution.

## B.1 EA Parameters and DLL Import

#property strict

input double InpLots      = 0.10;
input int    InpSlippage  = 5;
input int    InpMagic     = 777777;
input int    InpMaxSpread = 30;

#import "FlexionCore_DLL.dll"
   int EvaluateTick(double price, int timestamp, uchar &buffer[], int buf_size);
#import

## B.2 Utility: Count Open Positions

int FlexionCountOpenPositions()
{
   int count = 0;
   for(int i = OrdersTotal() - 1; i >= 0; i--)
   {
      if(!OrderSelect(i, SELECT_BY_POS, MODE_TRADES)) continue;
      if(OrderSymbol() != _Symbol)                     continue;
      if(OrderMagicNumber() != InpMagic)               continue;
      int type = OrderType();
      if(type == OP_BUY || type == OP_SELL) count++;
   }
   return count;
}

## B.3 Utility: Open BUY and SELL

bool FlexionOpenBuy()
{
   if(MarketInfo(_Symbol, MODE_SPREAD) > InpMaxSpread) return false;
   double price = NormalizeDouble(Ask, Digits);
   int ticket = OrderSend(_Symbol, OP_BUY, InpLots, price, InpSlippage, 0, 0, "FEW_UP", InpMagic, 0, clrGreen);
   return (ticket > 0);
}

bool FlexionOpenSell()
{
   if(MarketInfo(_Symbol, MODE_SPREAD) > InpMaxSpread) return false;
   double price = NormalizeDouble(Bid, Digits);
   int ticket = OrderSend(_Symbol, OP_SELL, InpLots, price, InpSlippage, 0, 0, "FEW_DOWN", InpMagic, 0, clrRed);
   return (ticket > 0);
}

## B.4 Utility: Close All Positions

void FlexionCloseAll()
{
   for(int i = OrdersTotal() - 1; i >= 0; i--)
   {
      if(!OrderSelect(i, SELECT_BY_POS, MODE_TRADES)) continue;
      if(OrderSymbol() != _Symbol)                     continue;
      if(OrderMagicNumber() != InpMagic)               continue;

      int type = OrderType();
      double price = 0.0;

      if(type == OP_BUY)      price = Bid;
      else if(type == OP_SELL) price = Ask;
      else                    continue;

      price = NormalizeDouble(price, Digits);
      OrderClose(OrderTicket(), OrderLots(), price, InpSlippage, clrYellow);
   }
}

## B.5 Initialization and Deinitialization

int OnInit()
{
   return(INIT_SUCCEEDED);
}

void OnDeinit(const int reason)
{
}

## B.6 Main Tick Handler

void OnTick()
{
   // Prepare output buffer
   uchar buffer[64];
   ArrayInitialize(buffer, 0);

   // Call structural engine
   int len = EvaluateTick(Bid, (int)TimeCurrent(), buffer, 64);
   if(len <= 0) return;

   // Extract signal code
   int signal = (int)buffer[0];
   int openCount = FlexionCountOpenPositions();

   // NONE → no action
   if(signal == 0) return;

   // FEW_UP → open BUY (if no position in current symbol/magic)
   if(signal == 1)
   {
      if(openCount == 0) FlexionOpenBuy();
      return;
   }

   // FEW_DOWN → open SELL
   if(signal == 2)
   {
      if(openCount == 0) FlexionOpenSell();
      return;
   }

   // FXB → close all positions
   if(signal == 3)
   {
      FlexionCloseAll();
      return;
   }
}

## B.7 Compliance With Theory

This EA implementation complies with Flexion Trading Theory V2.1:

- It never computes or infers structure.
- It never detects FEW or FXB internally.
- It never calculates orientation or phases.
- It executes exactly one trade per structural phase.
- It closes all positions on FXB unconditionally.
- It treats NONE as “do nothing” without side effects.

All structural logic—event detection, phase construction, orientation, and safety filtering—is fully encapsulated inside NFRE and the FlexionCore DLL. The EA remains a thin, deterministic execution wrapper around the structural engine.

---

# Appendix C — Implementation Contract

This appendix defines the mandatory implementation requirements for any environment integrating the Flexion Trading Engine. The rules specified here are strict and must be followed exactly. They ensure that the structural theory, safety logic, and trading decisions remain deterministic and platform-independent.

# C.1 DLL Import Contract
The engine exposes exactly one external function.  
Platforms must import it with the following signature:

#import "FlexionCore_DLL.dll"
   int EvaluateTick(double price, int timestamp, uchar &buffer[], int buf_size);
#import

The function name, argument order, argument types, and return type are immutable.

# C.2 Buffer Allocation
Before calling EvaluateTick, the caller must:

1. Allocate a buffer of at least 64 bytes:
   uchar buffer[64];

2. Zero-initialize it:
   ArrayInitialize(buffer, 0);

A non-zeroed buffer results in undefined behavior.  
Reading beyond the number of bytes returned by the function is forbidden.

# C.3 Signal Codes
The first byte of buffer[] contains the structural/safety decision:

0 = NONE  
1 = FEW_UP  
2 = FEW_DOWN  
3 = FXB  

These codes must be interpreted exactly as defined.  
No platform or user-defined reinterpretation is allowed.

# C.4 Structural Parameters (Optional Diagnostics)
If the engine writes additional bytes, they contain diagnostic structural values:

1. C(t)  
2. ΔS(t)  
3. T(t)  
4. M(t)  
5. μ(t)  
6. Θ(t)

All values are double-precision floats in fixed order.  
These parameters may be logged but must not influence execution behavior.

# C.5 Trading Behavior Contract
Platforms must follow these rules:

- FEW_UP   → open BUY  
- FEW_DOWN → open SELL  
- FXB      → close all open trades  
- NONE     → do nothing  

The platform must not:

- compute orientation,
- detect turning points,
- infer structure from price,
- use indicators or volatility measures,
- override or alter signal interpretation.

The engine's output is final.

# C.6 One Position Per Phase
The trading system must enforce the rule:

- Only one open position is allowed per symbol/magic during a structural phase.

Repeated FEW_UP/FEW_DOWN signals inside the same phase must be ignored.  
No pyramiding or partial re-entries are permitted.

# C.7 FXB Priority
FXB overrides all other signals and must:

- close all open positions immediately,
- disable any pending entries,
- reset the trading state until the next FEW.

No exceptions to FXB enforcement are allowed.

# C.8 NONE Behavior
NONE indicates that the structural engine produced no actionable event.  
Platforms must not interpret NONE as:

- a waiting condition for entry,
- a reversal signal,
- noise indication,
- or error state.

NONE = no structural event = no action.

# C.9 Time Handling Requirements
The timestamp parameter must:

- be an integer representing Unix time or platform time,
- be strictly non-decreasing,
- not repeat or skip backwards.

Out-of-order timestamps invalidate structural continuity and must be avoided.

# C.10 Error Handling
If EvaluateTick returns:
- a value ≤ 0 → ignore output,
- an invalid signal code → treat as NONE,
- NaN/INF structural parameters → automatically suppressed by internal safety.

The platform must never attempt to correct, modify, or reinterpret invalid output.

# C.11 Platform Independence
The Implementation Contract must hold identically across:

- MT4,
- MT5,
- cTrader,
- Python/C++ engines,
- research backtesting systems.

The interface, signal interpretation, and execution logic must not diverge across environments.

# C.12 Modification Restrictions
None of the following may be changed without breaking theoretical correctness:

- function signature,
- buffer structure,
- signal code definitions,
- event interpretation rules,
- orientation logic,
- FXB enforcement,
- NONE behavior.

Any deviation breaks compliance with Flexion Trading Theory V2.1.

# C.13 Summary
This contract guarantees that every trading environment executes structural signals exactly as defined by the theory. The platform is a passive interpreter, not an analytical component. All structure lives inside the NFRE engine; all decision-making arises from event geometry; all execution behavior follows this contract without exception.
